import{usePageRelationStore as $}from"./index-X-UolLy-.js";import{d as N,h as H,bc as G,C as S,c as u,b4 as X,o as s,k as E,j,t as A,f as t,e as c,w as l,n as d,F as q,aE as O,bU as Q,aT as I,H as W,x as h,m as T,l as z,G as J,e5 as _,a6 as K,a5 as B,a7 as Z,R as ee,an as te,L as ae,p as ne,fq as oe,cY as ie,fy as se,_ as le,fm as re,eg as M,aa as ce}from"./index-w4SHPE6S.js";import{S as ue}from"./SkeletonLoader-DVeigI1X.js";const de={class:"d-flex flex-direction-column gap-4"},pe={class:"align-items-center d-flex gap-3 text-5 text-regular"},ge=N({__name:"ActiveRelationsCard",props:{type:{},relations:{},pagination:{},isLoading:{type:Boolean}},setup(k,{emit:a}){const o=k,{t:n,locale:p}=H(),f=G(),y=$(),{CITY:g}=_,v=S(),m=u(()=>{const e=o.type===g?n("global.city"):n("global.page",p.value===X.EN?1:2),i=n("generics.no_active_item_relations",{item:e}),P=f.canAdministrateCurrentPage?o.type===g?n("global.relation_empty_state_disclaimer_city"):n("global.relation_empty_state_disclaimer_page"):"",x=f.canAdministrateCurrentPage?n("generics.form_item_relations",{item:e}):"";return{titleText:i,disclaimerText:P,buttonText:x}});function C(e){return e.name??e.name}const b=(e,i)=>e===_.PAGE?{name:K.HOME[1],params:{[B.PAGE]:i._id}}:{name:Z.CITY[1],params:{[B.CITY]:i.slug}};return(e,i)=>{const P=ee,x=ue,L=te,R=ae,U=ne,V=oe,Y=ie,D=se;return s(),E("div",de,[j("div",pe,A(t(n)(`global.${e.type}`,2)),1),t(y).isRelationsDataLoading?(s(),c(x,{key:0,class:"d-flex flex-direction-column gap-7 mx-0-sm mx-5"},{default:l(()=>[d(P,{amount:4})]),_:1})):e.relations?.length?(s(),c(Y,{key:1,class:"overflow-hidden"},{default:l(()=>[d(U,{ref_key:"listElement",ref:v},{default:l(()=>[(s(!0),E(q,null,z(e.relations,(r,F)=>(s(),c(R,{key:F},{default:l(()=>[d(O,{title:C(r),categories:t(Q)(r.categories,t(p)),to:b(e.type,r),"image-props":{src:r.profileImage?.modified},class:"p-5"},{actions:l(()=>[t(f).canAdministrateCurrentPage?(s(),c(L,{key:0,icon:"trash_can","button-type":t(I).TEXT,"text-classes":"d-none d-block-md",onClick:W(_e=>t(y).openDeleteRelation(r._id,r.name,e.type),["prevent"])},{default:l(()=>[h(A(t(n)("generics.delete_item",{item:t(n)("global.relation")})),1)]),_:2},1032,["button-type","onClick"])):T("",!0)]),_:2},1032,["title","categories","to","image-props"])]),_:2},1024))),128)),e.isLoading?(s(),c(R,{key:0,class:"d-flex flex-direction-column gap-7 p-5"},{default:l(()=>[d(P,{amount:2})]),_:1})):T("",!0)]),_:1},512),e.pagination?.nextUrl&&!e.isLoading?(s(),c(V,{key:0,class:"align-items-center d-flex p-5",divider:!1},{default:l(()=>[d(L,{"button-type":t(I).TEXT,class:"m-auto",onClick:i[0]||(i[0]=r=>a(t(J).EXPAND))},{default:l(()=>[h(A(t(n)("global.show_more")),1)]),_:1},8,["button-type"])]),_:1})):T("",!0)]),_:1})):(s(),c(D,{key:2,icon:e.type===t(g)?"city":"page","body-title":m.value.titleText,text:m.value.disclaimerText,"add-button":m.value.buttonText,onClickAddButton:i[1]||(i[1]=r=>t(y).addRelation(e.type))},null,8,["icon","body-title","text","add-button"]))])}}}),w=le(ge,[["__scopeId","data-v-fb693830"]]),me={class:"d-flex flex-direction-column gap-7 mx-0-sm mx-5"},Pe=N({__name:"ActiveRelations",setup(k){const a=$(),o=G(),n=S(!1),p=S(!1);re({title:u(()=>`${o.currentPage?.name}`)});const f=u(()=>o.canAdministrateCurrentPage?a.relations.cities.active:a.relations.cities.activePublic),y=u(()=>o.canAdministrateCurrentPage?a.relations.pages.active:a.relations.pages.activePublic),g=u(()=>o.canAdministrateCurrentPage?a.pagination.cities.active:a.pagination.cities.activePublic),v=u(()=>o.canAdministrateCurrentPage?a.pagination.pages.active:a.pagination.pages.activePublic),m=u(()=>o.canAdministrateCurrentPage?M.ACTIVE:M.ACTIVE_PUBLIC);async function C(){p.value=!0,await a.loadMoreRelationsByStatusAndScope(_.CITY,m.value,g.value?.nextUrl),p.value=!1}async function b(){n.value=!0,await a.loadMoreRelationsByStatusAndScope(_.PAGE,m.value,v.value?.nextUrl),n.value=!1}return ce(async()=>{typeof o.currentPage?._id=="string"&&await Promise.all([a.getActivePublicCityRelations(o.currentPage?._id),a.getActivePublicPageRelations(o.currentPage?._id)])}),(e,i)=>(s(),E("div",me,[d(w,{type:t(_).CITY,relations:f.value,pagination:g.value,"is-loading":p.value,onExpand:C},null,8,["type","relations","pagination","is-loading"]),d(w,{type:t(_).PAGE,relations:y.value,pagination:v.value,"is-loading":n.value,onExpand:b},null,8,["type","relations","pagination","is-loading"])]))}});export{Pe as default};
//# sourceMappingURL=ActiveRelations-G792U_7i.js.map
