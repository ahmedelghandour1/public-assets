import{d as _,o as d,k as M,n as s,e as b,H as R,az as $,m as B,aA as P,c as u,s as T,aB as L,I as j,f as t,A as O,j as E,w as p,t as I,x as S,av as F,au as V,aC as W,aD as z,aE as G,F as K,ak as H,G as q,am as Y,D as J,aF as X,ap as Z,X as D,Y as Q,aG as ee,a1 as te,aH as ae,h as oe,aI as re,aJ as ne,a4 as w,aK as h,aL as se,a3 as le,aM as ie,ar as ce,aN as pe}from"./index-w4SHPE6S.js";import{f as de}from"./banner_fallback-m6gCDzaA.js";import{A as ue}from"./article.enum-k6t03ACY.js";import{_ as me}from"./ShareDropdown-a_VEU8nZ.js";import{o as _e}from"./fancybox.utils-OAcz400z.js";import{E as ge}from"./tiptap.enum-DaggNILy.js";import{a as fe}from"./Tiptap-mgcYDGwa.js";import{usePageArticleStore as Ae}from"./index-R84J8ePS.js";import{m as we}from"./share-in-shortcut.mappers-vO65ArSd.js";import{C as he,a as Ie}from"./ability.config-HZLtEDQ0.js";import"./sharing-service-KZCJqIN7.js";import"./Alert-Q3JwRpHd.js";import"./image.utils-KDvitg1Z.js";import"./shortcut.enum-c9NJiojz.js";const Se={class:"d-flex gap-4"},be=_({__name:"ArticleDetailsButtons",props:{article:{},allowedToUpdateCurrentScope:{type:Boolean},dropdownOptions:{}},setup(c){const n=c;return(l,e)=>(d(),M("div",Se,[s(me,{class:"align-items-center height-percent-100 justify-content-center width-percent-100"}),n.allowedToUpdateCurrentScope?(d(),b($,{key:0,class:"align-self-flex-start","dropdown-items":n.dropdownOptions||[],onClick:e[0]||(e[0]=R(()=>{},["prevent"]))},null,8,["dropdown-items"])):B("",!0)]))}}),ve={class:"d-flex flex-direction-column gap-3 p-5 p-7-sm"},Ce={class:"align-items-center d-flex justify-content-space-between"},ye=_({__name:"ArticleDetailsBody",props:{article:{},allowedToUpdateCurrentScope:{type:Boolean},dropdownOptions:{}},setup(c){const n=c,{d:l}=P(),e=u(()=>T(n.article.bannerImage,{width:ue.ARTICLE_MEDIUM_BANNER_WIDTH,aspectRatio:L.TWENTY_ONE_TO_NINE})),o=u(()=>T(n.article.page?.profileImage,j.SIZE38));return(a,r)=>(d(),M(K,null,[s(O,{src:e.value,"object-fit":"cover",class:"cursor-pointer","fallback-image":t(de),onClick:r[0]||(r[0]=m=>t(_e)(n.article.bannerImage))},null,8,["src","fallback-image"]),E("div",ve,[s(F,{class:"text-7 text-shade-0"},{default:p(()=>[S(I(a.article.title),1)]),_:1}),E("div",Ce,[s(G,{is:W,to:t(z)(a.article.page?._id),target:"_blank",title:a.article.page?.name,"image-props":{src:o.value},class:"cursor-pointer"},{subtitle:p(()=>[S(I(t(l)(a.article.publishedAt,t(V).Post_Date)),1)]),_:1},8,["to","title","image-props"]),s(be,{article:a.article,"allowed-to-update-current-scope":a.allowedToUpdateCurrentScope,"dropdown-options":a.dropdownOptions},null,8,["article","allowed-to-update-current-scope","dropdown-options"])])])],64))}}),Te={name:"ArticlePreviewModal"},Ee=_({...Te,props:{article:{},allowedToUpdateCurrentScope:{type:Boolean},dropdownOptions:{}},setup(c){const n=c,{t:l}=P(),e=u(()=>n.article.content??n.article.plainContent);return(o,a)=>(d(),b(Z,{active:"",type:t(X).PREVIEW,fullscreen:"xs"},{default:p(()=>[s(H,{"close-button":"",class:"text-3 text-500 text-shade-0",onClose:a[0]||(a[0]=r=>o.$emit(t(q).CLOSE))},{default:p(()=>[S(I(t(l)("global.article")),1)]),_:1}),s(Y,{class:"p-0"},{default:p(()=>[s(ye,{article:o.article,"allowed-to-update-current-scope":o.allowedToUpdateCurrentScope,"dropdown-options":o.dropdownOptions},null,8,["article","allowed-to-update-current-scope","dropdown-options"]),s(J),s(fe,{class:"p-5 p-7-sm text-justify",content:e.value,"editor-type":t(ge).PageDescription,editable:!1,placeholder:t(l)("generics.enter_item",{item:t(l)("global.content")})},null,8,["content","editor-type","placeholder"])]),_:1})]),_:1},8,["type"]))}}),Ve=_({__name:"ArticleDetails",setup(c){const n=D(Q),{can:l}=D(ee),e=Ae(),o=te(),a=ae(),{t:r,locale:m}=oe(),g=re(),v=ne(),f=l(he.Update,{...e.currentArticle,subject:Ie.Article}),k=u(()=>[{iconName:"link",label:r("global.detailed_view"),action:()=>{o.showArticleDetailsModal=!1,a.push({name:w.ARTICLE[1],params:{articleId:h(e.currentArticle,m.value),id:e.currentArticle.page._id}}),e.currentArticle=null}},{iconName:"edit",label:r("global.edit"),hide:!f,action:()=>{o.showArticleDetailsModal=!1,a.push({name:w.ARTICLE[1],params:{articleId:h(e.currentArticle,m.value),id:e.currentArticle.page._id},query:{editMode:"true"}}),e.currentArticle=null}},{iconName:"trash_can",label:r("global.delete"),hide:!f,action:()=>{const i=ce(n).create({title:r("generics.remove_item_question",{item:r("global.article")}),description:r("generics.remove_item_confirmation_details",{item:r("global.article")}),confirmText:r("global.button.confirm"),cancelText:r("global.button.cancel")});i.open(),i.onAction().then(async()=>{o.showArticleDetailsModal=!1,await e.deleteArticle(e.currentArticle?._id)})}}]),C=u(()=>{const A=a.resolve({name:w.ARTICLE[1],params:{articleId:h(e.currentArticle,m.value)}});return`${se.userWebUrl}${a.resolve(A).href}`});async function x(){e.currentArticle&&g.shareInPostToPage(pe(e.currentArticle),e.currentArticle.page)}async function U(){e.currentArticle&&g.shareInShortcutToPageOrCity(we(e.currentArticle))}return le(ie,{canShareInPost:v.canShareInPost,canShareInShortcut:v.canShareInShortCut,shareLink:C.value,onShareInPost:x,onShareInShortcut:U,openExternalShareContext:g.shareExternalContent({url:C.value})}),(A,i)=>{const N=Ee;return d(),b(N,{active:t(o).showArticleDetailsModal,"onUpdate:active":i[0]||(i[0]=y=>t(o).showArticleDetailsModal=y),article:t(e).currentArticle,"allowed-to-update-current-scope":t(f),"dropdown-options":k.value,onClose:i[1]||(i[1]=y=>t(o).showArticleDetailsModal=!1)},null,8,["active","article","allowed-to-update-current-scope","dropdown-options"])}}});export{Ve as default};
//# sourceMappingURL=ArticleDetails-EFF5fLWg.js.map
